// File: frontend/src/styles/layout/_unified-chat-layout.scss
/**
 * @file _unified-chat-layout.scss
 * @description Styles for the UnifiedChatLayout.vue component.
 * Manages dynamic padding based on header/footer/log heights,
 * background effects, and overall structure for chat-centric views.
 * It's the visual and structural backbone for "Ephemeral Harmony" chat interfaces.
 *
 * @role Defines layout structure, dynamic spacing, and background aesthetics for chat views.
 * @dependencies `../abstracts/variables`, `../abstracts/mixins`.
 * @version 2.2.0 - Addressed SASS [mixed-decls] warnings.
 */

@use '../abstracts/variables' as var;
@use '../abstracts/mixins' as mixins;

.unified-chat-layout-wrapper {
  @apply relative flex flex-col w-full h-full overflow-hidden;
  background-color: hsl(var(--color-bg-primary-h, var.$default-color-bg-primary-h), var(--color-bg-primary-s, var.$default-color-bg-primary-s), var(--color-bg-primary-l, var.$default-color-bg-primary-l));
  color: hsl(var(--color-text-primary-h, var.$default-color-text-primary-h), var(--color-text-primary-s, var.$default-color-text-primary-s), var(--color-text-primary-l, var.$default-color-text-primary-l));

  // CSS custom properties for dynamic heights, set by JS in UnifiedChatLayout.vue
  --header-actual-height: #{var.$header-height-default}; // Default fallback
  --ephemeral-log-actual-height: 0px; // Default if not shown
  --voice-input-actual-height: var(--voice-input-panel-total-height-mobile, 80px); // Mobile first default guess

  // Corrected: Moved these padding declarations before the @media block to avoid [mixed-decls]
  padding-top: calc(var(--header-actual-height) + var(--ephemeral-log-actual-height) + #{var.$spacing-xs} + env(safe-area-inset-top, 0px));
  padding-bottom: calc(var(--voice-input-actual-height) + #{var.$spacing-xs} + env(safe-area-inset-bottom, 0px));
  padding-left: calc(var.$spacing-xs + env(safe-area-inset-left, 0px));
  padding-right: calc(var.$spacing-xs + env(safe-area-inset-right, 0px));

  @media (min-width: var.$breakpoint-md) {
    --voice-input-actual-height: var(--voice-input-panel-total-height, 110px); // Desktop default guess
  }

  @media (min-width: var.$breakpoint-lg) {
    padding-left: calc(#{var.$spacing-md} + env(safe-area-inset-left, 0px));
    padding-right: calc(#{var.$spacing-md} + env(safe-area-inset-right, 0px));
  }
}

.unified-chat-background-effects {
  @apply absolute inset-0 -z-10 overflow-hidden pointer-events-none; // Ensure it's behind content

  .fixed-holo-grid {
    @apply absolute inset-0 opacity-[0.04];
    background-image:
      linear-gradient(hsla(var(--color-accent-primary-h), var(--color-accent-primary-s), var(--color-accent-primary-l), 0.5) 1px, transparent 1px),
      linear-gradient(to right, hsla(var(--color-accent-primary-h), var(--color-accent-primary-s), var(--color-accent-primary-l), 0.5) 1px, transparent 1px);
    background-size: 40px 40px; // Grid size
    animation: holoGridScroll 120s linear infinite alternate; // Ensure holoGridScroll is defined
  }

  .orbit-container {
    @apply absolute inset-0;
    animation-name: orbitPathRotation; // Define orbitPathRotation if not already
    animation-timing-function: linear;
    animation-iteration-count: infinite;
  }
  .orbiting-shape {
    @apply absolute;
    // Base style, JS will override width, height, background, animation-duration, border-radius, filter, boxShadow
    width: 50px; height: 50px;
    background-color: hsla(var(--color-accent-primary-h), var(--color-accent-primary-s), var(--color-accent-primary-l), 0.1);
    border-radius: 50%;
    animation-name: shapeTransformAndFade; // Define shapeTransformAndFade if not already
    animation-timing-function: ease-in-out;
    animation-iteration-count: infinite;
    animation-direction: alternate;
  }
}

.unified-main-content-area {
  @apply flex-grow flex flex-col relative overflow-hidden min-h-0; // min-h-0 is crucial for flex children to scroll correctly
  // This area itself doesn't scroll; its direct child (e.g., ChatWindow) should.
}

.unified-voice-input-section {
  @apply fixed bottom-0 left-0 right-0 z-20; // z-index ensures it's above main content but below modals
  // Padding for safe areas handled by .unified-chat-layout-wrapper's padding-bottom
}

// Ensure these keyframes exist in your _keyframes.scss or a relevant animation file
@keyframes holoGridScroll {
  0% { background-position: 0% 0%; }
  100% { background-position: 100% 100%; }
}
@keyframes orbitPathRotation {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
@keyframes shapeTransformAndFade {
  0% { transform: scale(0.8) rotate(0deg); opacity: 0.5; }
  50% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
  100% { transform: scale(0.8) rotate(360deg); opacity: 0.5; }
}