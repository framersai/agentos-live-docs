// File: frontend/src/styles/components/_voice-input.scss
/**
 * @file _voice-input.scss
 * @description Styles for the VoiceInput component, Ephemeral Harmony theme.
 * Features holographic/glassmorphic elements, responsive microphone button,
 * animated live transcription display, and themed controls. Includes new animated send button.
 * @version 3.0.0
 */

@use '../abstracts/variables' as var;
@use '../abstracts/mixins' as mixins;
@use './buttons' as buttonsFile; // For button mixins if needed for other buttons

.voice-input-panel-ephemeral {
  // Existing glassmorphic pane and panel styles...
  @include mixins.glassmorphic-pane(
    hsla(var(--color-bg-secondary-h), var(--color-bg-secondary-s), var(--color-bg-secondary-l), 0.6), // Slightly less transparent
    hsla(var(--color-border-glass-h), var(--color-border-glass-s), var(--color-border-glass-l), 0.35),
    calc(var(--blur-glass) * 0.9), // Slightly less blur
    var(--shadow-depth-md)
  );
  border-radius: var.$radius-2xl;
  padding: var.$spacing-md;
  display: flex;
  flex-direction: column;
  gap: var.$spacing-sm;
  transition: border-color var.$duration-smooth, box-shadow var.$duration-smooth;

  &.processing, &.microphone-error { /* existing styles */ }
  &.microphone-denied { /* existing styles */ }
}

.input-area-ephemeral {
  display: flex;
  align-items: flex-end; // Align items to the bottom (for textarea and button)
  gap: var.$spacing-sm;
}

.voice-textarea-ephemeral {
  flex-grow: 1;
  resize: none;
  padding: var.$spacing-sm calc(var.$spacing-sm * 1.5);
  font-size: var(--font-size-base, var.$font-size-base-default); // Use themed font size
  line-height: 1.6; // Increased line height
  letter-spacing: var(--letter-spacing-base, var.$letter-spacing-base-default); // Use themed letter spacing
  border-radius: var.$radius-lg;
  min-height: 48px; // Consistent height with buttons
  max-height: 150px; // Max expansion
  background-color: hsla(var(--color-bg-primary-h), var(--color-bg-primary-s), var(--color-bg-primary-l), 0.6); // More transparent
  color: hsl(var(--color-text-primary-h), var(--color-text-primary-s), var(--color-text-primary-l));
  border: 1px solid hsla(var(--color-border-secondary-h), var(--color-border-secondary-s), var(--color-border-secondary-l), 0.4); // Softer border
  box-shadow: inset 0 1px 4px hsla(var(--shadow-color-h), var(--color-shadow-s), var(--color-shadow-l), 0.12);
  transition: border-color var.$duration-quick, box-shadow var.$duration-quick, background-color var.$duration-quick;
  @include mixins.custom-scrollbar('--color-accent-secondary', 0.3, 0.5, '--color-bg-primary', 0.1, 6px);


  &::placeholder {
    color: hsl(var(--color-text-muted-h), var(--color-text-muted-s), var(--color-text-muted-l));
    opacity: 0.7;
  }
  &:focus {
    outline: none;
    background-color: hsla(var(--color-bg-primary-h), var(--color-bg-primary-s), var(--color-bg-primary-l), 0.7);
    border-color: hsla(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l), 0.7);
    box-shadow: inset 0 1px 2px hsla(var(--shadow-color-h), var(--color-shadow-s), var(--color-shadow-l), 0.05),
                0 0 0 3px hsla(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l), 0.25);
    animation: inputFocusBreath 1.5s infinite alternate var.$ease-in-out-sine; // Defined in _keyframes.scss
  }
  &:disabled { /* existing styles */ }
}

// New Animated Send Button Styles
.send-button-ephemeral-v2 {
  @include buttonsFile.btn; // Base button styles
  @include buttonsFile.btn-primary-look; // Primary button appearance
  // Override size and shape for this specific button
  width: 48px;
  height: 48px;
  padding: 0 !important; // Remove padding if btn-icon-modifier not used or needs override
  border-radius: var.$radius-lg; // Match textarea
  flex-shrink: 0;
  overflow: hidden; // For icon animation effects

  .send-icon-animated-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  }

  .send-icon-animated {
    width: 20px; // Adjust size as needed
    height: 20px;
    stroke-width: 1.5; // For outline paths
    color: hsl(var(--color-text-on-primary-h), var(--color-text-on-primary-s), var(--color-text-on-primary-l)); // Icon color
    transition: transform 0.2s var.$ease-out-quad;

    .send-icon-shape {
      fill: currentColor; // Fill with the current text color
      transition: fill 0.2s var.$ease-out-quad;
    }
    .send-icon-trail {
      stroke: currentColor;
      stroke-opacity: 0;
      transition: stroke-opacity 0.3s var.$ease-out-quad, transform 0.3s var.$ease-out-quad;
    }
  }

  &:hover {
    .send-icon-animated {
      transform: scale(1.1) translateX(1px) translateY(-1px);
      .send-icon-shape {
         // Could change fill on hover if desired, e.g., brighter version of accent
      }
      .send-icon-trail-1 { stroke-opacity: 0.7; transform: translate(-3px, 3px) scaleX(0.8); transition-delay: 0s; }
      .send-icon-trail-2 { stroke-opacity: 0.5; transform: translate(-5px, 5px) scaleX(0.6); transition-delay: 0.05s; }
      .send-icon-trail-3 { stroke-opacity: 0.3; transform: translate(-7px, 7px) scaleX(0.4); transition-delay: 0.1s; }
    }
  }
  &:active {
    .send-icon-animated {
      transform: scale(0.9) translateX(0) translateY(0);
    }
  }
  &:disabled {
    .send-icon-animated .send-icon-shape {
       fill: hsla(var(--color-text-on-primary-h), var(--color-text-on-primary-s), var(--color-text-on-primary-l), 0.5);
    }
  }
}


.live-transcript-display-ephemeral { /* existing styles... */ }
.controls-main-row-ephemeral { /* existing styles... */ }
.mic-button-ephemeral { /* existing styles... */ }
.status-display-ephemeral { /* existing styles... */ }
.secondary-controls-ephemeral {
  /* Ensure buttons here use themed styles if not already */
  .control-btn-ephemeral {
    @include buttonsFile.btn-ghost;
    @include buttonsFile.btn-icon-modifier;
    // Any specific overrides for these small controls
    padding: var.$spacing-xs !important;
    border-radius: var.$radius-md;
    color: hsl(var(--color-text-muted-h), var(--color-text-muted-s), var(--color-text-muted-l));
    &:hover {
      color: hsl(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l));
      background-color: hsla(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l), 0.1);
    }
    &.stop-btn-ephemeral {
      color: hsl(var(--color-error-h), var(--color-error-s), var(--color-error-l));
       &:hover {
        background-color: hsla(var(--color-error-h), var(--color-error-s), var(--color-error-l), 0.1);
      }
    }
    .icon-base { width: 1rem; height: 1rem;}
  }
}
.vad-canvas-ephemeral { /* existing styles... */ }

// Styles for audio mode dropdown and its items
.audio-mode-selector-wrapper {
  position: relative;
}
.audio-mode-button { // Applied to the button that toggles the dropdown
  @include buttonsFile.btn-ghost; // Base look and feel
  // Specific sizing and appearance for this button in the voice input panel
  padding: var.$spacing-xs var.$spacing-sm !important;
  font-size: var.$font-size-xs !important;
  gap: var.$spacing-xs !important;
  border-radius: var.$radius-md !important;
  min-width: auto; // Allow it to size to content

  .icon-sm { width: 1em; height: 1em; }
  .chevron-icon { transition: transform var.$duration-quick; &.open { transform: rotate(180deg); } }
}

.audio-mode-dropdown {
  // Using the user-settings-dropdown-menu class as a base if the visual style is similar enough
  // or applying mixins directly.
  @include mixins.neomorphic-extrude( // Or glassmorphic, depending on desired look
    hsl(var(--color-bg-primary-h), var(--color-bg-primary-s), var(--color-bg-primary-l)),
    3px, 8px, var(--shadow-opacity-soft), var(--shadow-opacity-soft), var.$radius-lg,
    var(--shadow-color-h), var(--color-shadow-s), var(--color-shadow-l),
    calc(var(--color-shadow-l) + var(--shadow-highlight-modifier))
  );
  position: absolute;
  bottom: calc(100% + #{var.$spacing-xs}); // Position above the button
  right: 0; // Align to the right of the wrapper
  width: max-content;
  min-width: 180px;
  z-index: var.$z-index-dropdown;
  padding: var.$spacing-xs;
  
  .dropdown-header-holographic { /* from UserSettingsDropdown if applicable */ }
  .dropdown-item-holographic, .audio-mode-item { // Shared style for items
    @include buttonsFile.btn-ghost;
    width: 100%;
    justify-content: flex-start !important;
    font-size: var.$font-size-sm !important;
    padding: var.$spacing-sm !important;
    border-radius: var.$radius-md !important;

    &.active {
      background-color: hsla(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l), 0.15);
      color: hsl(var(--color-accent-interactive-h), var(--color-accent-interactive-s), var(--color-accent-interactive-l));
      font-weight: 500;
    }
    .icon-sm { margin-right: var.$spacing-sm; }
    .icon-xs { margin-left: auto; } // For checkmark
  }
}

// Modal styles (ensure they are robust in _modals.scss or here if specific)
.modal-overlay-ephemeral { /* Ensure it's styled for holographic theme */ }
.modal-content-ephemeral { /* Ensure it's styled for holographic theme */ }
// ... other modal sub-elements ...