@use 'sass:map';
/* tailwindcss-disable */
/* tailwindcss-intellisense-disable */

/* ---------------------------------------------------------------------------
 * Theme Engine – generates CSS-variables for every palette
 *----------------------------------------------------------------------------*/

// 1 — bring the individual maps into scope
@use './theme-definitions.scss' as themes; // $theme-warm-embrace, …

// 2 — master registry (id → {is-dark, map})
$theme-registry: (
  'warm-embrace':   ('is-dark': false, 'map': themes.$theme-warm-embrace),
  'twilight-neo':   ('is-dark': true,  'map': themes.$theme-twilight-neo),
  'aurora-daybreak':('is-dark': false, 'map': themes.$theme-aurora-daybreak),
);

// 3 — optional aliases for legacy IDs
$theme-aliases: (
  'ephemeral-holo-dark': 'twilight-neo',
  'aurora-light':        'aurora-daybreak',
  'legacy-warm-embrace': 'warm-embrace',
  'legacy-twilight-neo': 'twilight-neo',
);

// 4 — helper mixin
@mixin apply-theme($map) {
  @each $prop, $val in $map { #{$prop}: #{$val}; }
}

// 5 — output
$default-theme: 'aurora-daybreak'; // keep in sync with ThemeManager.ts

/* Fallback root vars (JS disabled) */
:root {
  @include apply-theme(map.get(map.get($theme-registry, $default-theme), 'map'));
  color-scheme: if(
    map.get(map.get($theme-registry, $default-theme), 'is-dark'),
    dark, light
  );
}

/* one selector per real theme */
@each $id, $meta in $theme-registry {
  html[data-theme="#{$id}"] {
    @include apply-theme(map.get($meta, 'map'));
    color-scheme: if(map.get($meta, 'is-dark'), dark, light);
  }
}

/* alias selectors (duplicate the vars, no @extend) */
@each $alias, $target in $theme-aliases {
  $target-meta: map.get($theme-registry, $target);
  $target-map : map.get($target-meta, 'map');
  $target-dark: map.get($target-meta, 'is-dark');

  html[data-theme="#{$alias}"] {
    @include apply-theme($target-map);
    color-scheme: if($target-dark, dark, light);
  }
}
