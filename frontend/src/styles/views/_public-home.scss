// File: frontend/src/styles/views/_public-home.scss
/**
 * @file _public-home.scss
 * @description Styles specific to the PublicHome view for "Ephemeral Harmony" theme.
 * Focuses on a visually engaging agent selector, informative placeholders,
 * and a clean, modern presentation of public-facing content.
 * @version 1.0.2 - Corrected SASS calculations, mixin calls, and ensured theme consistency.
 */

@use '../abstracts/variables' as var;
@use '../abstracts/mixins' as mixins;
@use '../components/buttons' as buttonsFile;
@use '../components/cards' as cardsFile; 

.public-home-view-ephemeral {
  display: flex;
  flex-direction: column;
  height: 100%; 
}

.public-agent-selector-area-ephemeral {
  padding: var.$spacing-md var.$spacing-lg;
  margin-bottom: var.$spacing-lg;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var.$spacing-sm;
  position: sticky; 
  top: 0;
  z-index: calc(#{var.$z-index-content-overlay} + 1); 
  
  background-color: hsla(var(--color-bg-primary-h, #{var.$default-color-bg-primary-h}), var(--color-bg-primary-s, #{var.$default-color-bg-primary-s}), var(--color-bg-primary-l, #{var.$default-color-bg-primary-l}), 0.6);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px); // Prefixed for Safari
  border-bottom: 1px solid hsla(var(--color-border-secondary-h, #{var.$default-color-border-secondary-h}), var(--color-border-secondary-s, #{var.$default-color-border-secondary-s}), var(--color-border-secondary-l, #{var.$default-color-border-secondary-l}), 0.15);
  box-shadow: var(--shadow-depth-sm, #{var.$scss-box-shadow-sm});

  .selector-title-ephemeral {
    font-size: var.$font-size-sm;
    color: hsl(var(--color-text-muted-h, #{var.$default-color-text-muted-h}), var(--color-text-muted-s, #{var.$default-color-text-muted-s}), var(--color-text-muted-l, #{var.$default-color-text-muted-l}));
    font-weight: 500;
  }
}

.agent-selector-button-ephemeral {
  @include buttonsFile.btn;
  @include mixins.neomorphic-extrude(
    $bg-color-var-prefix: '--color-bg-secondary',
    $distance: 4px, 
    $blur: 8px,
    $shadow-opacity-var: '--shadow-opacity-soft',
    $radius: var.$radius-lg,
    $shadow-h-var: '--shadow-color-h', 
    $shadow-s-var: '--shadow-color-s', 
    $shadow-l-var: '--shadow-color-l', 
    $highlight-l-modifier-css-var: '--shadow-highlight-modifier',
    $fb-bg-h: var.$default-color-bg-secondary-h, 
    $fb-bg-s: var.$default-color-bg-secondary-s, 
    $fb-bg-l: var.$default-color-bg-secondary-l, 
    $fb-bg-a: var.$fb-bg-a, // Use general fallback alpha
    $fb-shadow-op: var.$default-shadow-opacity-soft,
    $fb-shadow-h: var.$default-shadow-color-h, 
    $fb-shadow-s: var.$default-shadow-color-s, 
    $fb-shadow-l: var.$default-shadow-color-l,
    $fb-highlight-l-factor: var.$default-shadow-highlight-l-factor
  );
  padding: var.$spacing-sm var.$spacing-md !important;
  min-width: 280px;
  max-width: 90%;
  color: hsl(var(--color-text-primary-h, #{var.$default-color-text-primary-h}), var(--color-text-primary-s, #{var.$default-color-text-primary-s}), var(--color-text-primary-l, #{var.$default-color-text-primary-l}));
  font-size: var.$font-size-base-default;
  font-weight: 500;

  .selected-agent-icon {
    width: 1.4em; height: 1.4em;
    margin-right: var.$spacing-sm;
    opacity: 0.9;
    color: hsl(var(--color-accent-primary-h, #{var.$default-color-accent-primary-h}), var(--color-accent-primary-s, #{var.$default-color-accent-primary-s}), var(--color-accent-primary-l, #{var.$default-color-accent-primary-l}));
  }
  .chevron-icon {
    width: 1.1em; height: 1.1em;
    transition: transform var.$duration-quick var.$ease-out-quad;
    &.open { transform: rotate(180deg); }
  }

  &:hover {
    filter: brightness(1.1);
    color: hsl(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}), var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}), var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}));
    .selected-agent-icon { 
      opacity: 1; 
      filter: drop-shadow(0 0 3px hsla(var(--color-accent-primary-h, #{var.$default-color-accent-primary-h}), var(--color-accent-primary-s, #{var.$default-color-accent-primary-s}), var(--color-accent-primary-l, #{var.$default-color-accent-primary-l}), 0.7));
    }
  }
}

.agent-selector-dropdown-panel-ephemeral {
  @include cardsFile.card-base-styles; 
  @include cardsFile.card-neo-look;    

  position: absolute;
  top: calc(100% + #{var.$spacing-xs}); 
  left: 50%;
  transform: translateX(-50%);
  z-index: var.$z-index-dropdown;
  width: 300px;
  min-width: 100%;
  max-height: 60vh;
  padding: var.$spacing-xs !important; 
  
  .dropdown-header-holographic {
    padding: var.$spacing-sm var.$spacing-md;
    border-bottom: 1px solid hsla(var(--color-border-secondary-h, #{var.$default-color-border-secondary-h}),var(--color-border-secondary-s, #{var.$default-color-border-secondary-s}),var(--color-border-secondary-l, #{var.$default-color-border-secondary-l}),0.2);
    margin-bottom: var.$spacing-xs;
    .dropdown-title {
      font-size: var.$font-size-sm;
      font-weight: 600;
      color: hsl(var(--color-text-muted-h, #{var.$default-color-text-muted-h}),var(--color-text-muted-s, #{var.$default-color-text-muted-s}),var(--color-text-muted-l, #{var.$default-color-text-muted-l}));
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
  }
  .dropdown-content-holographic {
    padding: var.$spacing-xs; 
    overflow-y: auto;
    max-height: calc(60vh - #{var.$spacing-lg} - 40px); // Corrected: var.$spacing-sm * 2 -> var.$spacing-lg
    @include mixins.custom-scrollbar(
        '--color-accent-interactive', 
        0.4, 0.65, 
        '--color-bg-tertiary', 
        0.1, 
        6px
    );
  }
  .dropdown-item-holographic {
    @include buttonsFile.btn-ghost; 
    width: 100%;
    justify-content: flex-start !important;
    align-items: center;
    padding: var.$spacing-sm var.$spacing-md !important;
    border-radius: var.$radius-md !important;
    font-size: var.$font-size-base-default !important; 
    color: hsl(var(--color-text-secondary-h, #{var.$default-color-text-secondary-h}),var(--color-text-secondary-s, #{var.$default-color-text-secondary-s}),var(--color-text-secondary-l, #{var.$default-color-text-secondary-l}));

    &.active {
      background-color: hsla(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}),0.15);
      color: hsl(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}));
      font-weight: 500;
      .mode-icon-dd-holographic {
        background-color: hsla(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}),0.1);
        .icon-base {
            color: hsl(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}));
        }
      }
    }
     &:not(.active):hover {
      background-color: hsla(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}),0.08);
      color: hsl(var(--color-text-primary-h, #{var.$default-color-text-primary-h}),var(--color-text-primary-s, #{var.$default-color-text-primary-s}),var(--color-text-primary-l, #{var.$default-color-text-primary-l}));
       .mode-icon-dd-holographic {
         background-color: hsla(var(--color-bg-tertiary-h, #{var.$default-color-bg-tertiary-h}),var(--color-bg-tertiary-s, #{var.$default-color-bg-tertiary-s}),var(--color-bg-tertiary-l, #{var.$default-color-bg-tertiary-l}),0.9);
       }
    }

    .mode-icon-dd-holographic {
      width: 36px; height: 36px; padding: var.$spacing-xs; border-radius: var.$radius-md;
      display: flex; align-items: center; justify-content: center; flex-shrink: 0;
      margin-right: var.$spacing-md;
      background-color: hsla(var(--color-bg-tertiary-h, #{var.$default-color-bg-tertiary-h}),var(--color-bg-tertiary-s, #{var.$default-color-bg-tertiary-s}),var(--color-bg-tertiary-l, #{var.$default-color-bg-tertiary-l}),0.7);
      transition: background-color var.$duration-quick;
      .icon-base { 
        width: 1.25rem; height: 1.25rem;
        color: hsl(var(--color-text-muted-h, #{var.$default-color-text-muted-h}),var(--color-text-muted-s, #{var.$default-color-text-muted-s}),var(--color-text-muted-l, #{var.$default-color-text-muted-l}));
        transition: color var.$duration-quick;
      }
    }
    .dropdown-item-label { flex-grow: 1; text-align: left; }
    .checkmark-icon-active { 
        margin-left: auto; 
        color: hsl(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}),var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}),var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}));
        width: 1.25rem; height: 1.25rem;
    }
  }
}

.public-welcome-placeholder-ephemeral,
.rate-limit-banner-ephemeral {
  @include cardsFile.card-base-styles;
  @include cardsFile.card-glass-look;
  margin: var.$spacing-xl auto; 
  padding: calc(#{var.$spacing-xl} * 1.5); 
  text-align: center;
  max-width: 700px; 
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var.$spacing-md;

  .hero-icon-ephemeral, .banner-icon-ephemeral {
    width: clamp(4rem, 10vw, 5.5rem); 
    height: clamp(4rem, 10vw, 5.5rem);
    margin-bottom: var.$spacing-sm;
    color: hsl(var(--color-accent-primary-h, #{var.$default-color-accent-primary-h}), var(--color-accent-primary-s, #{var.$default-color-accent-primary-s}), var(--color-accent-primary-l, #{var.$default-color-accent-primary-l}));
    opacity: 0.7;
    filter: drop-shadow(0 0 15px hsla(var(--color-accent-primary-h, #{var.$default-color-accent-primary-h}), var(--color-accent-primary-s, #{var.$default-color-accent-primary-s}), var(--color-accent-primary-l, #{var.$default-color-accent-primary-l}), 0.5));
  }
  
  .welcome-title-ephemeral, .banner-title-ephemeral {
    font-size: clamp(1.5rem, calc(1rem + 1.5vw), 2.25rem); 
    font-weight: 600;
    color: hsl(var(--color-text-primary-h, #{var.$default-color-text-primary-h}), var(--color-text-primary-s, #{var.$default-color-text-primary-s}), var(--color-text-primary-l, #{var.$default-color-text-primary-l}));
    @include mixins.text-glow(
        $glow-color-var-prefix: '--color-accent-primary', 
        $glow-radius: 8px, 
        $fb-glow-h: var.$default-color-accent-primary-h,
        $fb-glow-s: var.$default-color-accent-primary-s,
        $fb-glow-l: var.$default-color-accent-primary-l,
        $fb-glow-a: 0.4
    );
  }

  .welcome-subtitle-ephemeral, .banner-text-ephemeral {
    font-size: clamp(1rem, calc(0.9rem + 0.5vw), 1.125rem); 
    color: hsl(var(--color-text-secondary-h, #{var.$default-color-text-secondary-h}), var(--color-text-secondary-s, #{var.$default-color-text-secondary-s}), var(--color-text-secondary-l, #{var.$default-color-text-secondary-l}));
    line-height: 1.7;
    max-width: 60ch; 
    opacity: 0.95;
    .link-ephemeral {
      color: hsl(var(--color-accent-interactive-h, #{var.$default-color-accent-interactive-h}), var(--color-accent-interactive-s, #{var.$default-color-accent-interactive-s}), var(--color-accent-interactive-l, #{var.$default-color-accent-interactive-l}));
      font-weight: 500;
      text-decoration: none;
      &:hover { text-decoration: underline; }
    }
  }
}

.rate-limit-banner-ephemeral {
  border-left: 5px solid hsl(var(--color-warning-h, #{var.$default-color-warning-h}), var(--color-warning-s, #{var.$default-color-warning-s}), var(--color-warning-l, #{var.$default-color-warning-l}));
  background-color: hsla(var(--color-warning-h, #{var.$default-color-warning-h}), var(--color-warning-s, #{var.$default-color-warning-s}), var(--color-warning-l, #{var.$default-color-warning-l}), 0.05);
  .banner-icon-ephemeral {
    color: hsl(var(--color-warning-h, #{var.$default-color-warning-h}), var(--color-warning-s, #{var.$default-color-warning-s}), var(--color-warning-l, #{var.$default-color-warning-l}));
    filter: drop-shadow(0 0 10px hsla(var(--color-warning-h, #{var.$default-color-warning-h}), var(--color-warning-s, #{var.$default-color-warning-s}), var(--color-warning-l, #{var.$default-color-warning-l}), 0.4));
  }
  .banner-title-ephemeral {
    color: hsl(var(--color-warning-h, #{var.$default-color-warning-h}), var(--color-warning-s, #{var.$default-color-warning-s}), calc(var(--color-warning-l, #{var.$default-color-warning-l}) - 10%));
    @include mixins.text-glow(
        $glow-color-var-prefix: '--color-warning', 
        $glow-radius: 6px, 
        $fb-glow-h: var.$default-color-warning-h,
        $fb-glow-s: var.$default-color-warning-s,
        $fb-glow-l: var.$default-color-warning-l,
        $fb-glow-a: 0.3
    );
  }
  .login-prompt-link-ephemeral {
    @include buttonsFile.btn-primary; 
    font-size: var.$font-size-base-default !important;
    padding: var.$spacing-sm var.$spacing-lg !important;
  }
}

.public-welcome-placeholder-ephemeral .hero-icon-ephemeral.no-agents-icon {
    color: hsl(var(--color-text-muted-h, #{var.$default-color-text-muted-h}), var(--color-text-muted-s, #{var.$default-color-text-muted-s}), var(--color-text-muted-l, #{var.$default-color-text-muted-l}));
    filter: none;
    opacity: 0.5;
}

.main-content-view-wrapper-ephemeral {
  flex-grow: 1; 
  display: flex;
  flex-direction: column;
}

.loading-placeholder-ephemeral {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 1;
  min-height: 300px;
}
